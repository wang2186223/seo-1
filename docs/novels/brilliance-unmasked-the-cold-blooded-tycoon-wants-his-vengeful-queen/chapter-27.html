<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 27 - Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen | Free Novel Online - NovelVibe</title>
    <meta name="description" content="Read Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen Chapter 27 on NovelVibe - Free werewolf romance novels">
    <meta name="keywords" content="free novel online, romance, fantasy, novel updates, light novel, apothecary diaries light novel, heavens official blessing novel, dune novel, read novel free, online novel, romance novel, graphic novel, visual novel, novel master, novel synonym, school spirits graphic novel, how many words in a novel, free novels online">
    <meta name="robots" content="index, follow">
    
    <!-- Time Meta Tags for SEO -->
    
    <meta property="article:published_time" content="2025-11-28T13:03:09.871093">
    <meta property="article:modified_time" content="2025-11-28T13:03:09.871093">
    <meta name="date" content="2025-11-28">
    <meta name="last-modified" content="2025-11-28 13:03:09">
    
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Chapter 27">
    <meta property="og:description" content="Read Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen online for free">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.arknovel1.xyz/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/chapter-27">
    <meta property="og:image" content="/covers/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen-ScreenShot_2025-11-27_104240_384.png">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Chapter 27">
    <meta name="twitter:description" content="Read Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen online">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.arknovel1.xyz/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/chapter-27">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KM9R2XBQSL"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-KM9R2XBQSL');
    </script>
    
    <!-- Page Visit Statistics Code -->
    <script>
    // Page visit data collection
    function sendPageVisit() {
        // First get user IP address
        getUserIP().then(userIP => {
            const data = {
                page: window.location.href,
                userAgent: navigator.userAgent,
                userIP: userIP,
                referrer: getReferrerSource(),
                referrerUrl: document.referrer || 'Direct/None'
            };
            
            // Send data to Google Apps Script
            fetch('https://script.google.com/macros/s/AKfycbyF5Vot_R9Rq_hoZmcPeK_-2rY9tPphz9jLsru1KX7z-krv7-LIJ90fFHSJ0tNJbPQX/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).catch(error => {
                console.log('Analytics error:', error);
            });
        }).catch(error => {
            // If IP retrieval fails, still send other data
            const data = {
                page: window.location.href,
                userAgent: navigator.userAgent,
                userIP: 'Unknown',
                referrer: getReferrerSource(),
                referrerUrl: document.referrer || 'Direct/None'
            };
            
            fetch('https://script.google.com/macros/s/AKfycbyF5Vot_R9Rq_hoZmcPeK_-2rY9tPphz9jLsru1KX7z-krv7-LIJ90fFHSJ0tNJbPQX/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).catch(error => {
                console.log('Analytics error:', error);
            });
        });
    }
    
    // Get referrer source (traffic source detection) - Enhanced version
    function getReferrerSource() {
        const referrer = document.referrer || '';
        const urlParams = new URLSearchParams(window.location.search);
        const currentPath = window.location.pathname;
        
        // Check URL parameters first (for tracking campaigns)
        if (urlParams.has('utm_source')) {
            const source = urlParams.get('utm_source');
            const medium = urlParams.get('utm_medium') || '';
            const campaign = urlParams.get('utm_campaign') || '';
            return `UTM Campaign: ${source}${medium ? '/' + medium : ''}${campaign ? '/' + campaign : ''}`;
        }
        if (urlParams.has('fbclid')) {
            return 'Paid: Facebook Ads';
        }
        if (urlParams.has('gclid')) {
            return 'Paid: Google Ads';
        }
        
        // If no referrer, it's direct traffic
        if (!referrer) {
            // Try to distinguish different types of direct traffic
            if (document.cookie.includes('returning_visitor')) {
                return 'Direct: Returning Visitor';
            }
            return 'Direct: First Visit or Bookmark';
        }
        
        // Parse referrer URL
        try {
            const refUrl = new URL(referrer);
            const refHost = refUrl.hostname.toLowerCase();
            const refPath = refUrl.pathname;
            
            // Check if it's from same domain (internal navigation)
            if (refHost === window.location.hostname) {
                // Detect specific internal pages
                if (refPath === '/' || refPath === '/index.html') {
                    return 'Internal: From Homepage';
                } else if (refPath.includes('/novels/') && !refPath.includes('/chapter-')) {
                    return 'Internal: From Novel Detail Page';
                } else if (refPath.includes('/chapter-')) {
                    return 'Internal: From Another Chapter';
                } else if (refPath.includes('/all-novels')) {
                    return 'Internal: From All Novels List';
                } else {
                    return 'Internal: Site Navigation';
                }
            }
            
            // Search Engines
            if (refHost.includes('google.')) {
                // Try to detect organic vs images
                if (refPath.includes('/imgres')) {
                    return 'Organic: Google Images';
                }
                return 'Organic: Google Search';
            }
            if (refHost.includes('bing.com')) {
                return 'Organic: Bing Search';
            }
            if (refHost.includes('yahoo.com')) {
                return 'Organic: Yahoo Search';
            }
            if (refHost.includes('duckduckgo.com')) {
                return 'Organic: DuckDuckGo';
            }
            if (refHost.includes('baidu.com')) {
                return 'Organic: Baidu Search';
            }
            
            // Social Media Platforms
            if (refHost.includes('facebook.com') || refHost.includes('fb.com')) {
                return 'Social: Facebook';
            }
            if (refHost.includes('instagram.com')) {
                return 'Social: Instagram';
            }
            if (refHost.includes('twitter.com') || refHost.includes('t.co')) {
                return 'Social: Twitter/X';
            }
            if (refHost.includes('tiktok.com')) {
                return 'Social: TikTok';
            }
            if (refHost.includes('reddit.com')) {
                return 'Social: Reddit';
            }
            if (refHost.includes('pinterest.com')) {
                return 'Social: Pinterest';
            }
            if (refHost.includes('linkedin.com')) {
                return 'Social: LinkedIn';
            }
            if (refHost.includes('youtube.com')) {
                return 'Social: YouTube';
            }
            if (refHost.includes('tumblr.com')) {
                return 'Social: Tumblr';
            }
            if (refHost.includes('quora.com')) {
                return 'Social: Quora';
            }
            
            // Novel/Reading platforms
            if (refHost.includes('wattpad.com')) {
                return 'Referral: Wattpad';
            }
            if (refHost.includes('webnovel.com')) {
                return 'Referral: WebNovel';
            }
            if (refHost.includes('goodreads.com')) {
                return 'Referral: Goodreads';
            }
            
            // Known competitor or partner sites
            if (refHost.includes('novel') || refHost.includes('book') || refHost.includes('read')) {
                return 'Referral: Novel Site (' + refHost + ')';
            }
            
            // Other external referrers (show domain for analysis)
            return 'External: ' + refHost;
        } catch (e) {
            return 'Error: Invalid Referrer';
        }
    }
    
    // Set returning visitor cookie
    (function() {
        if (!document.cookie.includes('returning_visitor')) {
            // Set cookie for 30 days
            const expires = new Date();
            expires.setTime(expires.getTime() + (30 * 24 * 60 * 60 * 1000));
            document.cookie = 'returning_visitor=1; expires=' + expires.toUTCString() + '; path=/';
        }
    })();
    
    // Get user IP address
    async function getUserIP() {
        try {
            // Method 1: Use free IP API
            const response = await fetch('https://api.ipify.org?format=json');
            const ipData = await response.json();
            return ipData.ip;
        } catch (error1) {
            try {
                // Method 2: Backup IP API
                const response = await fetch('https://httpbin.org/ip');
                const ipData = await response.json();
                return ipData.origin.split(',')[0].trim();
            } catch (error2) {
                try {
                    // Method 3: Third backup API
                    const response = await fetch('https://jsonip.com');
                    const ipData = await response.json();
                    return ipData.ip;
                } catch (error3) {
                    console.log('IP retrieval failed, using Unknown');
                    return 'Unknown';
                }
            }
        }
    }
    
    // Send visit data after page load
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', sendPageVisit);
    } else {
        sendPageVisit();
    }
    </script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/assets/css/chapter.css">
    
    <!-- Schema.org Structured Data for Article -->
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Chapter 27 - Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen",
        "alternativeHeadline": "Chapter 27: Chapter 27",
        "author": {
            "@type": "Person",
            "name": "Unknown Author"
        },
        "datePublished": "2025-11-28T13:03:09.871093",
        "dateModified": "2025-11-28T13:03:09.871093",
        "publisher": {
            "@type": "Organization",
            "name": "NovelVibe",
            "url": "https://www.arknovel1.xyz",
            "logo": {
                "@type": "ImageObject",
                "url": "https://www.arknovel1.xyz/assets/images/logo.png"
            }
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://www.arknovel1.xyz/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/chapter-27"
        },
        "url": "https://www.arknovel1.xyz/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/chapter-27",
        
        "image": {
            "@type": "ImageObject",
            "url": "/covers/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen-ScreenShot_2025-11-27_104240_384.png"
        },
        
        "articleSection": "Chapter",
        "wordCount": "916",
        "isPartOf": {
            "@type": "Book",
            "name": "Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen",
            "author": {
                "@type": "Person",
                "name": "Unknown Author"
            }
        }
    }
    </script>
    
    
    <!-- Breadcrumb Navigation Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://www.arknovel1.xyz/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen",
                "item": "https://www.arknovel1.xyz/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/"
            },
            {
                "@type": "ListItem",
                "position": 3,
                "name": "Chapter 27",
                "item": "https://www.arknovel1.xyz/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/chapter-27"
            }
        ]
    }
    </script>
    
    <!-- FAQ Schema for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "Can I read free novels online?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes! You can read Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen and thousands of other free novels online at NovelVibe. We offer light novels, graphic novels, visual novels, romance novels, and more without registration or payment."
                }
            },
            {
                "@type": "Question",
                "name": "How do I get novel updates?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Visit NovelVibe regularly for daily novel updates. We add new chapters to Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen and other novels frequently. Bookmark this page to stay updated with the latest novel master content."
                }
            },
            {
                "@type": "Question",
                "name": "What is a light novel?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "A light novel is a style of novel primarily targeting young adults. Popular examples include Apothecary Diaries light novel and Heaven's Official Blessing novel. Our free novel online platform includes various light novels, romance novels, and other popular fiction genres like Dune novel."
                }
            },
            {
                "@type": "Question",
                "name": "What is a graphic novel?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "A graphic novel is a book-length comic narrative. Examples include School Spirits graphic novel and Forever graphic novel. While we focus on text-based novels, we cover various novel formats and genres."
                }
            },
            {
                "@type": "Question",
                "name": "How many words in a novel?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "A typical novel contains 50,000-100,000 words. Light novels are often shorter (40,000-50,000 words), while epic novels can exceed 120,000 words. Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen offers engaging storytelling regardless of length."
                }
            },
            {
                "@type": "Question",
                "name": "What is a novel synonym?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Novel synonyms include: book, story, fiction, narrative, tale, romance, literature. On NovelVibe, you can explore all types of novels including light novels, graphic novels, visual novels, and classic romance novels."
                }
            }
        ]
    }
    </script>
    
    <!-- Ahrefs Analytics -->
    <script src="https://analytics.ahrefs.com/analytics.js" data-key="E2ZZe80dfDLAEGhT2iI37A" async></script>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="left-header">
                    <a href="/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/" class="btn" id="back-btn">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                    <a href="/" class="logo">NovelVibe</a>
                </div>
                <div class="right-header">
                    <a href="/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/" class="btn" id="toc-btn" title="Table of Contents">
                        <i class="fas fa-list"></i>
                    </a>
                    <div class="theme-toggle" id="theme-btn"></div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <h1 class="chapter-title">Chapter 27</h1>
            <div class="content font-medium">
                
                
                <p>Nothing in Arabella&#39;s life had prepared her for someone as shameless as Meagan.</p>
                
                
                
                <p>She kept her voice even. &#34;The villa has already been sold. If you&#39;re still there after Sunday, don&#39;t blame me for what happens.&#34;</p>
                
                
                
                <p>Without waiting for a reply, Arabella ended the call.</p>
                
                
                
                <p>Meagan glared at her phone, fuming over the call that had just ended. She tried calling back, but there was no answer. Rage spiled out as she muttered to herself, &#34;That bitch! If she ever comes back, I&#39;ll show her what real discipline is.&#34;</p>
                
                
                
                <p>On the couch, Khloe lounged in front of the TV,admiring herself in her phone screen&#39;s reflection.The scars on her face had faded a lot, just as she had been promised.</p>
                
                
                
                <p>Curiosity got the better of Khloe. &#34;Who was that,Mom? Was it Arabella?&#34;</p>
                
                
                
                <p>Meagan gave a cold smile. &#34;Of course it was. That little bitch actually told us to get out. She claims</p>
                
                
                
                <p>she sold the villa. I&#39;d like to see who&#39;s bold enough to buy it. Whoever they are, I&#39;ll make sure the deal falls apart.&#34;</p>
                
                
                
                <p>Khloe hardly looked worried. &#34;We&#39;re not leaving.Let&#39;s see if anyone actually dares to buy the house!&#34;</p>
                
                
                
                <p>Plans were already in motion. If someone did show up, they intended to spread rumors about the place being haunted.</p>
                
                
                
                <p>A smirk curled Khloe&#39;s lips. &#34;Arabella is just too naive.&#34;</p>
                
                
                
                <p>Her expression turned brighter as she remembered something. &#34;By the way, tomorrow is Elissa&#39;s big rehearsal. A lot of important people will be there. Can I go?&#34;</p>
                
                
                
                <p>At the mention of Elissa, a smile broke through Meagan&#39;s irritation. &#34;We can&#39;t just waltz in, but after it&#39;s over, we can pay her a visit.&#34;</p>
                
                
                
                <p>The thought made Khloe beam. &#34;That&#39;s great! I&#39;m going to start live streaming again, Mom.&#34;</p>
                
                
                
                <p>With her face healed, she finally felt ready to return to streaming.</p>
                
                
                
                <p>&#34;Go on then,&#34; Meagan answered, applying a fresh face mask.</p>
                
                
                
                <p>She didn&#39;t take Arabella&#39;s words seriously.</p>
                
                
                
                <p>The following day arrived, bringing rehearsal day at Griridge Theatre.</p>
                
                
                
                <p>Arabella and Karlie sat among the audience when a familiar voice called out, &#34;Daisy?&#34;</p>
                
                
                
                <p>Her gaze lifted to see Kenzie and several others walking over. A few dance students had been invited to watch, and by coincidence, Kenzie ended up right beside Arabella.</p>
                
                
                
                <p>The sightof Arabella left Kenzie speechless.</p>
                
                
                
                <p>Shock hit her when she realized Arabella was unscathed. Weren&#39;t Maryam&#39;s people supposed to have taken her away?</p>
                
                
                
                <p>Kenzie couldn&#39;t hold back. &#34;How did you manage to get out?&#34; Her face twisted with mixed emotions.</p>
                
                
                
                <p>&#34;Why do you even care?&#34; Arabella asked sharply,her voice laced with scorn.</p>
                
                
                
                <p>The answer left Kenzie irritated and even more annoyed. She scanned Arabella up and down,letting out a mocking laugh. &#34;Have you been planning payback while you were away? Like l said before, you can try all you want, but you&#39;ll never take on Joyce and her friends. Poor girls</p>
                
                
                
                <p>like you stay poor!&#34;</p>
                
                
                
                <p>A smug smile crossed her lips. &#34;If you beg me right now, maybe I&#39;ll speak up for you and get Joyce to go easy on you.&#34;</p>
                
                
                
                <p>With Joyce&#39;s influence behind her, Kenzie had no problem throwing her weight around.</p>
                
                
                
                <p>Arabella gave a half smile. &#34;Sure.&#34;</p>
                
                
                
                <p>Kenzie said, &#34;Then get down and apologize.&#34;</p>
                
                
                
                <p>Kenzie&#39;s phone appeared in her hand. Arabella could tell this wasn&#39;t the first time Daisy had been pushed into this.</p>
                
                
                
                <p>Inside, Kenzie sneered. So Daisy still hadn&#39;t changed, and she was just as timid as before.</p>
                
                
                
                <p>Due to her humble beginnings, she was stuck tagging along behind Elissa&#39;s circle. The only way she could feed her fragile ego was by belittling Daisy whenever she got the chance.</p>
                
                
                
                <p>A sudden crash echoed through the room.</p>
                
                
                
                <p>Something had smacked into Kenzie&#39;s knee,making her collapse to the floor.</p>
                
                
                
                <p>A flicker of humor danced in Arabella&#39;s eyes as she looked down. &#34;You&#39;re pretty skilled at begging. Must be second nature by now. Or</p>
                
                
                
                <p>maybe it&#39;s just because Elissa and Joyce have never let you stand up for yourself, right?&#34;</p>
                
                
                
                <p>Kenzie&#39;s face drained of color. &#34;You witch! How dare you pull this on me?&#34;</p>
                
                
                
                <p>Karlie chimed in, &#34;The performance is about to start.&#34;</p>
                
                
                
                <p>Sure enough, the stage lights dimmed, and Kenzie had no choice but to hold back her anger,silently vowing to get even with Arabella later.</p>
                
                
                
                <p>Frustration simmered inside her.</p>
                
                
                
                <p>In Kenzie&#39;s mind, Daisy&#39;s stubbornness was the reason she kept landing in trouble.</p>
                
                
                
                <p>Only a minute passed before the dance performance got underway.</p>
                
                
                
                <p>The dancers moved with such grace that the entire audience sat entranced.</p>
                
                
                
                <p>Occasionally, someone whispered, &#34;Isn&#39;t this one of Isabella&#39;s pieces? It&#39;s really stunning.&#34;</p>
                
                
                
                <p>&#34;Absolutely, Isabella is truly remarkable, and she stands among the finest dancers in the country.&#34;</p>
                
                
                
                <p>&#34;Elissa&#39;s solo is amazing too!&#34; someone added.</p>
                
                
                
                <p>&#34;You know, she choreographed it herself. That takes real skill,&#34; another person replied.</p>
                
                
                
                <p>Elissa&#39;s solo performance quickly drew its own share of attention.</p>
                
                
                
                <p>As the last note faded, the audience broke into applause and words of praise filled the air.</p>
                
                
                
                <p>&#34;That was incredible!&#34;</p>
                
                
                
                <p>&#34;Elissa&#39;s solo was especially impressive!&#34;</p>
                
                
                
                <p>&#34;The younger dancers are surpassing the veterans these days.&#34;</p>
                
                
                
                <p>Cheers and compliments followed Elissa as she took her bow and exited the stage, her face glowing with pride.</p>
                
                
                
                <p>Kenzie&#39;s eyes darkened as she turned and gave Arabella a smug look. &#34;Did you see that, Daisy?That&#39;s the difference between you and Elissa.You&#39;ll always be stuck here in the audience.&#34;</p>
                
                
                
                <p>A cold look settled on Arabella&#39;s face. &#34;And what about you? No matter how talented Elissa is,you&#39;re still just plain old Kenzie. It&#39;s almost laughable, the way you hide behind someone else&#39;s achievements just to feel important.&#34;</p>
                
                
            </div>
            
            <div class="font-controls">
                <button class="font-btn" id="small-font">A</button>
                <button class="font-btn active" id="medium-font">A</button>
                <button class="font-btn" id="large-font">A</button>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                
                <a href="/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/chapter-26" class="nav-btn" id="prev-chapter">
                    <i class="fas fa-arrow-left"></i> Previous
                </a>
                
                
                
                <a href="/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/chapter-28" class="nav-btn" id="next-chapter">
                    Next <i class="fas fa-arrow-right"></i>
                </a>
                
            </div>
        </div>
    </footer>

    <script>
        // DOM Elements
        const themeBtn = document.getElementById('theme-btn');
        const backBtn = document.getElementById('back-btn');
        const smallFontBtn = document.getElementById('small-font');
        const mediumFontBtn = document.getElementById('medium-font');
        const largeFontBtn = document.getElementById('large-font');
        const content = document.querySelector('.content');

        // Theme Toggle
        if (themeBtn) {
            themeBtn.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                // Save theme preference
                localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
            });
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
        // Load saved theme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
        }   smallFontBtn.addEventListener('click', () => {
                content.classList.remove('font-medium', 'font-large');
                content.classList.add('font-small');
                updateFontButtons(smallFontBtn);
                localStorage.setItem('fontSize', 'small');
            });
        }

        if (mediumFontBtn) {
            mediumFontBtn.addEventListener('click', () => {
                content.classList.remove('font-small', 'font-large');
                content.classList.add('font-medium');
                updateFontButtons(mediumFontBtn);
                localStorage.setItem('fontSize', 'medium');
            });
        }

        if (largeFontBtn) {
            largeFontBtn.addEventListener('click', () => {
                content.classList.remove('font-small', 'font-medium');
                content.classList.add('font-large');
                updateFontButtons(largeFontBtn);
                localStorage.setItem('fontSize', 'large');
            });
        }

        function updateFontButtons(activeBtn) {
            [smallFontBtn, mediumFontBtn, largeFontBtn].forEach(btn => {
                if (btn) btn.classList.remove('active');
            });
            activeBtn.classList.add('active');
        }

        // Load saved font size
        const savedFontSize = localStorage.getItem('fontSize');
        if (savedFontSize) {
            content.classList.remove('font-small', 'font-medium', 'font-large');
            content.classList.add('font-' + savedFontSize);
            
            const fontButtons = {
                'small': smallFontBtn,
                'medium': mediumFontBtn,
                'large': largeFontBtn
            };
            
            if (fontButtons[savedFontSize]) {
                updateFontButtons(fontButtons[savedFontSize]);
            }
        }

        // Next chapter domain configuration
        const NEXT_CHAPTER_DOMAIN = 'https://novel.kvlj.top';
        
        // Function to redirect next chapter to configured domain
        function getNextChapterUrl(originalUrl) {
            if (!NEXT_CHAPTER_DOMAIN || !originalUrl) {
                return originalUrl;
            }
            
            try {
                const url = new URL(originalUrl, window.location.origin);
                const pathname = url.pathname; // e.g., /novels/the-last-spirit-wolf/chapter-2
                return NEXT_CHAPTER_DOMAIN + pathname;
            } catch (e) {
                console.error('Error constructing next chapter URL:', e);
                return originalUrl;
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                const prevBtn = document.getElementById('prev-chapter');
                if (prevBtn && !prevBtn.disabled) {
                    window.location.href = prevBtn.href;
                }
            } else if (e.key === 'ArrowRight') {
                const nextBtn = document.getElementById('next-chapter');
                if (nextBtn && !nextBtn.disabled) {
                    // 键盘操作也跳转到配置的域名
                    const targetUrl = getNextChapterUrl(nextBtn.href);
                    window.location.href = targetUrl;
                }
            } else if (e.key === 'Escape') {
                closeSidebarFunc();
            }
        });
        
        // Intercept next chapter button click (只对真实用户点击生效，爬虫会看到原始href)
        document.addEventListener('DOMContentLoaded', function() {
            const nextBtn = document.getElementById('next-chapter');
            if (nextBtn && !nextBtn.disabled && NEXT_CHAPTER_DOMAIN) {
                // 保留原始href供爬虫抓取，只拦截点击事件
                nextBtn.addEventListener('click', function(e) {
                    // 阻止默认跳转
                    e.preventDefault();
                    // 真实用户点击时跳转到配置的域名
                    const targetUrl = getNextChapterUrl(this.href);
                    window.location.href = targetUrl;
                });
            }
        });

        // URL参数传递系统 - 保留流量来源追踪参数
        (function() {
            // 提取当前URL中的追踪参数
            function getTrackingParams() {
                const urlParams = new URLSearchParams(window.location.search);
                const trackingParams = {};
                
                // 需要保留的参数列表
                const paramsToKeep = [
                    'fbclid',           // Facebook Click ID
                    'utm_source',       // UTM来源
                    'utm_medium',       // UTM媒介
                    'utm_campaign',     // UTM活动
                    'utm_term',         // UTM关键词
                    'utm_content',      // UTM内容
                    'utm_id',           // UTM ID
                    'gclid',            // Google Click ID
                    'msclkid',          // Microsoft Click ID
                    'ref',              // 引荐来源
                    'source'            // 通用来源参数
                ];
                
                paramsToKeep.forEach(param => {
                    if (urlParams.has(param)) {
                        trackingParams[param] = urlParams.get(param);
                    }
                });
                
                return trackingParams;
            }
            
            // 将参数对象转换为查询字符串
                    window.location.href = targetUrl;
                }
            }
        });     ).join('&');
            }
            
            // 为URL添加追踪参数
            function addTrackingParamsToUrl(url, trackingParams) {
                if (Object.keys(trackingParams).length === 0) return url;
                
                // 解析URL
                const urlObj = new URL(url, window.location.origin);
                
                // 添加追踪参数（不覆盖已存在的参数）
                Object.entries(trackingParams).forEach(([key, value]) => {
                    if (!urlObj.searchParams.has(key)) {
                        urlObj.searchParams.set(key, value);
                    }
                });
                
                // 返回相对路径（保持原有格式）
                return urlObj.pathname + urlObj.search + urlObj.hash;
            }
            
            // 页面加载时应用追踪参数到所有站内链接
            document.addEventListener('DOMContentLoaded', function() {
                const trackingParams = getTrackingParams();
                
                // 如果有追踪参数，则应用到所有站内链接
                if (Object.keys(trackingParams).length > 0) {
                    // 选择所有站内链接
                    const internalLinks = document.querySelectorAll('a[href^="/"], a[href^="./"], a[href^="../"]');
                    
                    internalLinks.forEach(link => {
                        const currentHref = link.getAttribute('href');
                        if (currentHref && !currentHref.includes('?')) {
                            // 如果链接还没有查询参数，直接添加
                            link.setAttribute('href', currentHref + paramsToQueryString(trackingParams));
                        } else if (currentHref && currentHref.includes('?')) {
                            // 如果已有查询参数，智能合并
                            link.setAttribute('href', addTrackingParamsToUrl(currentHref, trackingParams));
                        }
                    });
                    
                    console.log('追踪参数已应用到所有站内链接:', trackingParams);
                }
            });
        })();

        // 记录阅读历史
        document.addEventListener('DOMContentLoaded', function() {
            const novelData = {
                title: 'Brilliance Unmasked： The Cold-Blooded Tycoon Wants His Vengeful Queen',
                url: '/novels/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen/',
                cover_url: '/covers/brilliance-unmasked-the-cold-blooded-tycoon-wants-his-vengeful-queen-ScreenShot_2025-11-27_104240_384.png',
                lastRead: new Date().toISOString(),
                currentChapter: 27
            };
            
            let history = JSON.parse(localStorage.getItem('readingHistory') || '[]');
            
            // 移除已存在的记录
            history = history.filter(item => item.title !== novelData.title);
            
            // 添加到开头
            history.unshift(novelData);
            
            // 只保留最近5条记录
            history = history.slice(0, 5);
            
            localStorage.setItem('readingHistory', JSON.stringify(history));
        });

    </script>
</body>
</html>